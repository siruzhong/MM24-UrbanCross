checkpoint/rsitmd/SWAN/SWAN_best.pth.tar
-------------------------
# Hyper Parameters setting
gpuid: 0
experiment_name: SWAN
model_name: SWAN
data_name: rsitmd
k_fold_current_num: 0
ckpt_save_path: ./checkpoint/
resnet_ckpt: ./aid_28-rsp-resnet-50-ckpt.pth
resume: checkpoint/rsitmd/SWAN/SWAN_best.pth.tar
data_path: ./fix_data/rsitmd_precomp/
image_path: ../rs_data/rsitmd/images/
vocab_path: ./vocab/rsitmd_splits_vocab.json
batch_size: 100
batch_size_val: 100
shard_size: 128
workers: 3
k_fold_nums: 3
distributed: False
init_method: tcp://localhost:18888
rank: 0
world_size: 2
use_mix_precision: False
embed_dim: 512
margin: 0.2
max_violation: False
grad_clip: 0.0
word_dim: 300
use_bidirectional_rnn: True
num_layers: 1
seed: 0
il_measure: False
is_finetune: False
sk_1: 2
sk_2: 3
cross_attn: i2t
agg_func: LogSumExp
lambda_lse: 6.0
lambda_softmax: 9.0
raw_feature_norm: softmax
-------------------------

=> using bidirectional rnn:True
Words: 1330/1349 found in vocabulary; 19 words missing
Total Params:  40462342
Total Requires_grad Params:  16892840
=> loading checkpoint 'checkpoint/rsitmd/SWAN/SWAN_best.pth.tar'
====== best rsum is : 21.99,   epoch is 40 =======

--------------------- start test ---------------------
/hpc2hdd/home/xhao390/.local/lib/python3.7/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /hpc2hdd/home/xhao390/.local/lib/python3.7/site-packages/torchvision/image.so: undefined symbol: _ZN2at4_ops19empty_memory_format4callEN3c108ArrayRefIlEENS2_8optionalINS2_10ScalarTypeEEENS5_INS2_6LayoutEEENS5_INS2_6DeviceEEENS5_IbEENS5_INS2_12MemoryFormatEEE
  warn(f"Failed to load image Python extension: {e}")
/hpc2hdd/home/xhao390/.local/lib/python3.7/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 3 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
Traceback (most recent call last):
  File "test_single.py", line 128, in <module>
    sims = main(args)
  File "test_single.py", line 119, in main
    sims = test(args, test_loader, model)
  File "/hpc2hdd/home/xhao390/py/SWAN-pytorch-main/engine.py", line 249, in test
    for i, val_data in enumerate(test_loader):
  File "/hpc2hdd/home/xhao390/.local/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/hpc2hdd/home/xhao390/.local/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/hpc2hdd/home/xhao390/.local/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/hpc2hdd/home/xhao390/.local/lib/python3.7/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
FileNotFoundError: Caught FileNotFoundError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/hpc2hdd/home/xhao390/.local/lib/python3.7/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/hpc2hdd/home/xhao390/.local/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/hpc2hdd/home/xhao390/.local/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/hpc2hdd/home/xhao390/py/SWAN-pytorch-main/data.py", line 89, in __getitem__
    image = Image.open(self.img_path  +str(self.images[img_id])[2:-1]).convert('RGB')
  File "/hpc2hdd/home/xhao390/.local/lib/python3.7/site-packages/PIL/Image.py", line 3236, in open
    fp = builtins.open(filename, "rb")
FileNotFoundError: [Errno 2] No such file or directory: '../rs_data/rsitmd/images/boat_0.tif'

